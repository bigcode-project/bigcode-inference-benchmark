# bigcode-inference-benchmark
A100 80GB

BLOOM\
```python
hidden_size = 2048
n_head = 16
n_layer = 24
```

Throughput (tokens/sec | msec/token)
| batch_size |    HF (fp32)    |    HF (bf16)    |    HF (int8)    | DS-inference (fp16) |
|:----------:|:---------------:|:---------------:|:---------------:|:-------------------:|
| 1          | 44.38 \| 22.53  | 41.00 \| 24.39  |                 | 61.61 | 16.23       |
| 2          | 85.82 \| 11.65  | 79.20 \| 12.63  |                 | 121.55 | 8.23       |
| 4          | 171.77 \| 5.82  | 160.72 \| 6.22  |                 | 240.06 | 4.17       |
| 8          | 334.21 \| 2.99  | 317.56 \| 3.15  |                 | 492.42 | 2.03       |
| 16         | 658.77 \| 1.52  | 644.14 \| 1.55  |                 | 970.59 | 1.03       |
| 32         | 1312.31 \| 0.76 | 1277.62 \| 0.78 |                 | 1999.04 | 0.50      |
| 64         | 2312.48 \| 0.43 | 2683.15 \| 0.37 |                 | 3971.09 | 0.25      |
| 128        | 2686.37 \| 0.37 | 4766.97 \| 0.21 |                 | 7514.59 | 0.13      |
| 256        | 3313.04 \| 0.30 | 6578.06 \| 0.15 |                 | 10226.50 | 0.10     |
| 384        | 3253.52 \| 0.31 | 7285.37 \| 0.14 |                 | 11094.27 | 0.09     |
| 512        | 3361.34 \| 0.30 | 7436.71 \| 0.13 |                 | 11390.85 | 0.09     |
| 640        | 3497.55 \| 0.29 | 7554.05 \| 0.13 |                 | 11625.71 | 0.09     |
| 768        | 3460.71 \| 0.29 | 7678.89 \| 0.13 |                 | 11814.31 | 0.08     |
| 896        | 3339.99 \| 0.30 | 7542.81 \| 0.13 |                 | 11744.38 | 0.09     |
| 1024       | oom             | 7702.06 \| 0.13 |                 | 11534.95 | 0.09     |
| 1152       | oom             | 7719.68 \| 0.13 |                 | oom                 |
| 1280       | oom             | 7786.51 \| 0.13 |                 | oom                 |
| 1408       | oom             | 7770.26 \| 0.13 |                 | oom                 |
| 1536       | oom             | 7783.86 \| 0.13 |                 | oom                 |
| 1664       | oom             | 7772.43 \| 0.13 |                 | oom                 |
| 1792       | oom             | 7747.92 \| 0.13 |                 | oom                 |
| 1920       | oom             | oom             |                 | oom                 |

Latency (sec)
| batch_size | HF (fp32) | HF (bf16) | HF (int8) | DS-inference (fp16) |
|:----------:|:---------:|:---------:|:---------:|:-------------------:|
| 1          | 2.25      | 2.44      |           | 1.62                |
| 2          | 2.33      | 2.53      |           | 1.65                |
| 4          | 2.33      | 2.49      |           | 1.67                |
| 8          | 2.39      | 2.52      |           | 1.62                |
| 16         | 2.43      | 2.48      |           | 1.65                |
| 32         | 2.44      | 2.50      |           | 1.60                |
| 64         | 2.77      | 2.39      |           | 1.61                |
| 128        | 4.76      | 2.69      |           | 1.70                |
| 256        | 7.73      | 3.89      |           | 2.50                |
| 384        | 11.80     | 5.27      |           | 3.46                |
| 512        | 15.23     | 6.88      |           | 4.49                |
| 640        | 18.30     | 8.47      |           | 5.51                |
| 768        | 22.19     | 10.00     |           | 6.50                |
| 896        | 26.83     | 11.88     |           | 7.63                |
| 1024       | oom       | 13.30     |           | 8.88                |
| 1152       | oom       | 14.92     |           | oom                 |
| 1280       | oom       | 16.44     |           | oom                 |
| 1408       | oom       | 18.12     |           | oom                 |
| 1536       | oom       | 19.73     |           | oom                 |
| 1664       | oom       | 21.41     |           | oom                 |
| 1792       | oom       | 23.13     |           | oom                 |
| 1920       | oom       | oom       |           | oom                 |