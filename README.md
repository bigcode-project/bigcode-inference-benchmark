# bigcode-inference-benchmark
A100 80GB

BLOOM\
```python
hidden_size = 2048
n_head = 16
n_layer = 24
```

Throughput (tokens/sec | msec/token)
| batch_size |    HF (fp32)    |    HF (bf16)    |    HF (int8)    | DS-inference (fp16) |
|:----------:|:---------------:|:---------------:|:---------------:|:-------------------:|
| 1          | 51.59 \| 19.38  | 47.46 \| 21.07  |                 | 61.61 | 16.23       |
| 2          | 103.92 \| 9.62  | 96.88 \| 10.32  |                 | 121.55 | 8.23       |
| 4          | 211.96 \| 4.72  | 193.72 \| 5.16  |                 | 240.06 | 4.17       |
| 8          | 411.79 \| 2.43  | 370.67 \| 2.70  |                 | 492.42 | 2.03       |
| 16         | 804.55 \| 1.24  | 781.29 \| 1.28  |                 | 970.59 | 1.03       |
| 32         | 1574.68 \| 0.64 | 1539.19 \| 0.65 |                 | 1999.04 | 0.50      |
| 64         | 2712.46 \| 0.37 | 3038.01 \| 0.33 |                 | 3971.09 | 0.25      |
| 128        | 2974.36 \| 0.34 | 5795.97 \| 0.17 |                 | 7514.59 | 0.13      |
| 256        | 3695.44 \| 0.27 | 8216.27 \| 0.12 |                 | 10226.50 | 0.10     |
| 384        | 3591.13 \| 0.28 | 9328.18 \| 0.11 |                 | 11094.27 | 0.09     |
| 512        | 3708.54 \| 0.27 | 9446.34 \| 0.11 |                 | 11390.85 | 0.09     |
| 640        | 3859.43 \| 0.26 | 9572.53 \| 0.10 |                 | 11625.71 | 0.09     |
| 768        | 3804.82 \| 0.26 | 9464.75 \| 0.11 |                 | 11814.31 | 0.08     |
| 896        | 3652.42 \| 0.27 | 9482.11 \| 0.11 |                 | 11744.38 | 0.09     |
| 1024       | oom             | 9710.46 \| 0.10 |                 | 11534.95 | 0.09     |
| 1152       | oom             | 9712.39 \| 0.10 |                 | oom                 |
| 1280       | oom             | 9667.19 \| 0.10 |                 | oom                 |
| 1408       | oom             | 9771.91 \| 0.10 |                 | oom                 |
| 1536       | oom             | 9744.56 \| 0.10 |                 | oom                 |
| 1664       | oom             | 9719.82 \| 0.10 |                 | oom                 |
| 1792       | oom             | 9690.61 \| 0.10 |                 | oom                 |
| 1920       | oom             | oom             |                 | oom                 |

Latency (sec)
| batch_size | HF (fp32) | HF (bf16) | HF (int8) | DS-inference (fp16) |
|:----------:|:---------:|:---------:|:---------:|:-------------------:|
| 1          | 1.94      | 2.11      |           | 1.62                |
| 2          | 1.92      | 2.06      |           | 1.65                |
| 4          | 1.89      | 2.06      |           | 1.67                |
| 8          | 1.94      | 2.16      |           | 1.62                |
| 16         | 1.99      | 2.05      |           | 1.65                |
| 32         | 2.03      | 2.08      |           | 1.60                |
| 64         | 2.36      | 2.11      |           | 1.61                |
| 128        | 4.30      | 2.21      |           | 1.70                |
| 256        | 6.93      | 3.12      |           | 2.50                |
| 384        | 10.69     | 4.12      |           | 3.46                |
| 512        | 14.82     | 5.42      |           | 4.49                |
| 640        | 19.85     | 6.69      |           | 5.51                |
| 768        | 20.18     | 8.11      |           | 6.50                |
| 896        | 24.53     | 9.45      |           | 7.63                |
| 1024       | oom       | 10.55     |           | 8.88                |
| 1152       | oom       | 11.86     |           | oom                 |
| 1280       | oom       | 13.24     |           | oom                 |
| 1408       | oom       | 14.41     |           | oom                 |
| 1536       | oom       | 15.76     |           | oom                 |
| 1664       | oom       | 17.12     |           | oom                 |
| 1792       | oom       | 18.49     |           | oom                 |
| 1920       | oom       | oom       |           | oom                 |